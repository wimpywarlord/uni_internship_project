var list_of_featured_movies = {
    "Sheet1" : [  {
            "Serial": "14",
            "Movie_name": "Harry Potter and the Chamber of Secrets",
            "Star_rating": "3",
            "Year": "2002",
            "isFeatured": "TRUE"
        },
        {
            "Serial": "52",
            "Movie_name": "Star Wars: The Force Awakens",
            "Star_rating": "1",
            "Year": "2015",
            "isFeatured": "TRUE"
        },
        {
            "Serial": "29",
            "Movie_name": "Up",
            "Star_rating": "3",
            "Year": "2009",
            "isFeatured": "TRUE"
        },
        {
            "Serial": "70",
            "Movie_name": "Captain America: Civil War",
            "Star_rating": "4",
            "Year": "2016",
            "isFeatured": "TRUE"
        },
        {
            "Serial": "6",
            "Movie_name": "Pirates of the Caribbean: At World's End",
            "Star_rating": "2",
            "Year": "2007",
            "isFeatured": "TRUE"
        },
        ]
}

var list_of_all_movies = 
{
    "Sheet1": [
        {
            "Serial": "73",
            "Movie_name": "Captain Marvel",
            "Star_rating": "2",
            "Year": "2019",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "64",
            "Movie_name": "Frozen",
            "Star_rating": "2",
            "Year": "2013",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "14",
            "Movie_name": "Harry Potter and the Chamber of Secrets",
            "Star_rating": "3",
            "Year": "2002",
            "isFeatured": "TRUE"
        },
        {
            "Serial": "93",
            "Movie_name": "Harry Potter and the Deathly Hallows - Part 1",
            "Star_rating": "4",
            "Year": "2010",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "11",
            "Movie_name": "Harry Potter and the Goblet of Fire",
            "Star_rating": "4",
            "Year": "2005",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "8",
            "Movie_name": "Harry Potter and the Half-Blood Prince",
            "Star_rating": "5",
            "Year": "2009",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "31",
            "Movie_name": "Ice Age: The Meltdown",
            "Star_rating": "5",
            "Year": "2006",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "66",
            "Movie_name": "Incredibles 2",
            "Star_rating": "5",
            "Year": "2018",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "54",
            "Movie_name": "Jurassic World",
            "Star_rating": "5",
            "Year": "2015",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "47",
            "Movie_name": "King Kong",
            "Star_rating": "5",
            "Year": "2005",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "40",
            "Movie_name": "Madagascar: Escape 2 Africa",
            "Star_rating": "3",
            "Year": "2008",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "46",
            "Movie_name": "Night at the Museum",
            "Star_rating": "3",
            "Year": "2006",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "43",
            "Movie_name": "Quantum of Solace",
            "Star_rating": "1",
            "Year": "2008",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "81",
            "Movie_name": "Rogue One: A Star Wars Story",
            "Star_rating": "5",
            "Year": "2016",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "89",
            "Movie_name": "Star Wars: The Rise of Skywalker",
            "Star_rating": "3",
            "Year": "2019",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "77",
            "Movie_name": "The Dark Knight Rises",
            "Star_rating": "5",
            "Year": "2012",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "67",
            "Movie_name": "The Fate of the Furious",
            "Star_rating": "4",
            "Year": "2017",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "95",
            "Movie_name": "The Hobbit: The Battle of the Five Armies",
            "Star_rating": "4",
            "Year": "2014",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "35",
            "Movie_name": "The Incredibles",
            "Star_rating": "4",
            "Year": "2004",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "38",
            "Movie_name": "The Passion of the Christ",
            "Star_rating": "4",
            "Year": "2004",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "100",
            "Movie_name": "The Secret Life of Pets",
            "Star_rating": "3",
            "Year": "2016",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "87",
            "Movie_name": "Zootopia",
            "Star_rating": "3",
            "Year": "2016",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "86",
            "Movie_name": "Alice in Wonderland",
            "Star_rating": "1",
            "Year": "2010",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "53",
            "Movie_name": "Avengers: Infinity War",
            "Star_rating": "5",
            "Year": "2018",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "84",
            "Movie_name": "Despicable Me 3",
            "Star_rating": "1",
            "Year": "2017",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "16",
            "Movie_name": "Finding Nemo",
            "Star_rating": "4",
            "Year": "2003",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "59",
            "Movie_name": "Frozen II",
            "Star_rating": "4",
            "Year": "2019",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "57",
            "Movie_name": "Furious 7",
            "Star_rating": "3",
            "Year": "2015",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "68",
            "Movie_name": "Iron Man 3",
            "Star_rating": "2",
            "Year": "2013",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "79",
            "Movie_name": "Joker",
            "Star_rating": "2",
            "Year": "2019",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "50",
            "Movie_name": "Madagascar",
            "Star_rating": "5",
            "Year": "2005",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "83",
            "Movie_name": "Pirates of the Caribbean: On Stranger Tides",
            "Star_rating": "4",
            "Year": "2011",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "32",
            "Movie_name": "Pirates of the Caribbean: The Curse of the Black Pearl",
            "Star_rating": "5",
            "Year": "2003",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "98",
            "Movie_name": "Spider-Man: Homecoming",
            "Star_rating": "4",
            "Year": "2017",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "52",
            "Movie_name": "Star Wars: The Force Awakens",
            "Star_rating": "1",
            "Year": "2015",
            "isFeatured": "TRUE"
        },
        {
            "Serial": "49",
            "Movie_name": "The Day After Tomorrow",
            "Star_rating": "5",
            "Year": "2004",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "91",
            "Movie_name": "The Jungle Book",
            "Star_rating": "1",
            "Year": "2016",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "30",
            "Movie_name": "The Twilight Saga: New Moon",
            "Star_rating": "5",
            "Year": "2009",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "28",
            "Movie_name": "Transformers",
            "Star_rating": "2",
            "Year": "2007",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "74",
            "Movie_name": "Transformers: Dark of the Moon",
            "Star_rating": "4",
            "Year": "2011",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "29",
            "Movie_name": "Up",
            "Star_rating": "3",
            "Year": "2009",
            "isFeatured": "TRUE"
        },
        {
            "Serial": "44",
            "Movie_name": "I Am Legend",
            "Star_rating": "1",
            "Year": "2007",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "22",
            "Movie_name": "Indiana Jones and the Kingdom of the Crystal Skull",
            "Star_rating": "4",
            "Year": "2008",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "92",
            "Movie_name": "Jumanji: Welcome to the Jungle",
            "Star_rating": "1",
            "Year": "2017",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "63",
            "Movie_name": "Jurassic World: Fallen Kingdom",
            "Star_rating": "3",
            "Year": "2018",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "33",
            "Movie_name": "Star Wars: Episode II – Attack of the Clones",
            "Star_rating": "4",
            "Year": "2002",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "17",
            "Movie_name": "Star Wars: Episode III – Revenge of the Sith",
            "Star_rating": "1",
            "Year": "2005",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "56",
            "Movie_name": "The Avengers",
            "Star_rating": "1",
            "Year": "2012",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "25",
            "Movie_name": "The Chronicles of Narnia",
            "Star_rating": "5",
            "Year": "2005",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "88",
            "Movie_name": "The Hobbit: An Unexpected Journey",
            "Star_rating": "2",
            "Year": "2012",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "80",
            "Movie_name": "Toy Story 3",
            "Star_rating": "4",
            "Year": "2010",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "18",
            "Movie_name": "Transformers: Revenge of the Fallen",
            "Star_rating": "5",
            "Year": "2009",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "58",
            "Movie_name": "Avengers: Age of Ultron",
            "Star_rating": "4",
            "Year": "2015",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "51",
            "Movie_name": "Avengers: Endgame",
            "Star_rating": "4",
            "Year": "2019",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "65",
            "Movie_name": "Beauty and the Beast",
            "Star_rating": "2",
            "Year": "2017",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "70",
            "Movie_name": "Captain America: Civil War",
            "Star_rating": "4",
            "Year": "2016",
            "isFeatured": "TRUE"
        },
        {
            "Serial": "90",
            "Movie_name": "Despicable Me 2",
            "Star_rating": "3",
            "Year": "2013",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "85",
            "Movie_name": "Finding Dory",
            "Star_rating": "2",
            "Year": "2016",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "36",
            "Movie_name": "Hancock",
            "Star_rating": "2",
            "Year": "2008",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "7",
            "Movie_name": "Harry Potter and the Order of the Phoenix",
            "Star_rating": "1",
            "Year": "2007",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "5",
            "Movie_name": "Harry Potter and the Philosopher's Stone",
            "Star_rating": "4",
            "Year": "2001",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "21",
            "Movie_name": "Harry Potter and the Prisoner of Azkaban",
            "Star_rating": "1",
            "Year": "2004",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "99",
            "Movie_name": "Ice Age: Continental Drift",
            "Star_rating": "1",
            "Year": "2012",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "39",
            "Movie_name": "Mamma Mia!",
            "Star_rating": "1",
            "Year": "2008",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "3",
            "Movie_name": "Pirates of the Caribbean: Dead Man's Chest",
            "Star_rating": "5",
            "Year": "2006",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "20",
            "Movie_name": "Shrek the Third",
            "Star_rating": "3",
            "Year": "2007",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "75",
            "Movie_name": "Skyfall",
            "Star_rating": "2",
            "Year": "2012",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "23",
            "Movie_name": "Spider-Man 2",
            "Star_rating": "2",
            "Year": "2004",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "72",
            "Movie_name": "Spider-Man: Far From Home",
            "Star_rating": "3",
            "Year": "2019",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "24",
            "Movie_name": "The Da Vinci Code",
            "Star_rating": "5",
            "Year": "2006",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "4",
            "Movie_name": "The Dark Knight",
            "Star_rating": "3",
            "Year": "2008",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "15",
            "Movie_name": "The Lord of the Rings: The Fellowship of the Ring",
            "Star_rating": "5",
            "Year": "2001",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "2",
            "Movie_name": "The Lord of the Rings: The Return of the King",
            "Star_rating": "2",
            "Year": "2003",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "78",
            "Movie_name": "Toy Story 4",
            "Star_rating": "5",
            "Year": "2019",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "76",
            "Movie_name": "Transformers: Age of Extinction",
            "Star_rating": "3",
            "Year": "2014",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "27",
            "Movie_name": "2012",
            "Star_rating": "3",
            "Year": "2009",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "82",
            "Movie_name": "Aladdin",
            "Star_rating": "2",
            "Year": "2019",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "71",
            "Movie_name": "Aquaman",
            "Star_rating": "4",
            "Year": "2018",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "1",
            "Movie_name": "Avatar",
            "Star_rating": "5",
            "Year": "2009",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "60",
            "Movie_name": "Black Panther",
            "Star_rating": "5",
            "Year": "2018",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "96",
            "Movie_name": "Bohemian Rhapsody",
            "Star_rating": "3",
            "Year": "2018",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "41",
            "Movie_name": "Casino Royale",
            "Star_rating": "5",
            "Year": "2006",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "61",
            "Movie_name": "Harry Potter and the Deathly Hallows – Part 2",
            "Star_rating": "3",
            "Year": "2011",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "13",
            "Movie_name": "Ice Age: Dawn of the Dinosaurs",
            "Star_rating": "3",
            "Year": "2009",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "45",
            "Movie_name": "Iron Man",
            "Star_rating": "4",
            "Year": "2008",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "34",
            "Movie_name": "Kung Fu Panda",
            "Star_rating": "1",
            "Year": "2008",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "69",
            "Movie_name": "Minions",
            "Star_rating": "1",
            "Year": "2015",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "48",
            "Movie_name": "Mission: Impossible 2",
            "Star_rating": "3",
            "Year": "2000",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "6",
            "Movie_name": "Pirates of the Caribbean: At World's End",
            "Star_rating": "2",
            "Year": "2007",
            "isFeatured": "TRUE"
        },
        {
            "Serial": "37",
            "Movie_name": "Ratatouille",
            "Star_rating": "2",
            "Year": "2007",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "10",
            "Movie_name": "Shrek 2",
            "Star_rating": "4",
            "Year": "2004",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "97",
            "Movie_name": "Spectre",
            "Star_rating": "4",
            "Year": "2015",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "19",
            "Movie_name": "Spider-Man",
            "Star_rating": "3",
            "Year": "2002",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "12",
            "Movie_name": "Spider-Man 3",
            "Star_rating": "2",
            "Year": "2007",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "62",
            "Movie_name": "Star Wars: The Last Jedi",
            "Star_rating": "2",
            "Year": "2017",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "94",
            "Movie_name": "The Hobbit: The Desolation of Smaug",
            "Star_rating": "2",
            "Year": "2013",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "55",
            "Movie_name": "The Lion King",
            "Star_rating": "2",
            "Year": "2019",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "9",
            "Movie_name": "The Lord of the Rings: The Two Towers",
            "Star_rating": "1",
            "Year": "2002",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "26",
            "Movie_name": "The Matrix Reloaded",
            "Star_rating": "4",
            "Year": "2003",
            "isFeatured": "FALSE"
        },
        {
            "Serial": "42",
            "Movie_name": "War of the Worlds",
            "Star_rating": "2",
            "Year": "2005",
            "isFeatured": "FALSE"
        }
    ]
};

var list_of_all_the_thumbnails = ["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w"];


var express = require("express");
var bodyParser = require("body-parser");


var app = express();
app.use(bodyParser.urlencoded({extended : true}));

app.use(express.static(__dirname + '/public'));

app.get("/",function(req,res){
	res.render("index.ejs")
});

app.post("/logout",function(req,res)
    {
        res.redirect("/");
    });


app.post("/home",function(req,res){


	// console.log(req.body.email);
	res.render("home.ejs",{
        "list_of_movies"  : list_of_all_movies,
        "list_of_all_the_thumbnails" : list_of_all_the_thumbnails,
    });

});

app.post("/home_sort_by_name",function(req,res){

    var list_of_all_movies_sorted_by_movie_name = {
    "Sheet1" : list_of_all_movies.Sheet1.sort((a, b) => (a.Movie_name > b.Movie_name) ? 1 : -1),
    };

    res.render("home.ejs",{
        "list_of_movies"  : list_of_all_movies_sorted_by_movie_name,
        "list_of_all_the_thumbnails" : list_of_all_the_thumbnails,
    });

    // console.log(list_of_all_movies_sorted_by_movie_name);
    console.log("THIS IS SORT BY NAME");
});

app.post("/search_movie",function(req,res){

    var flag_found = 0;
    var the_found_movie_details = { Sheet1 : [
        
        ]}
    console.log(req.body.search_value);
    var the_name_of_the_movie_to_be_searched_in_lower_case = req.body.search_value.toLowerCase(); 
    for(var i = 0 ; i < list_of_all_movies.Sheet1.length ; i++)
    {
        if((list_of_all_movies.Sheet1[i].Movie_name).includes(req.body.search_value))
        {

            the_found_movie_details.Sheet1.push(list_of_all_movies.Sheet1[i]);
            
            
            flag_found = 1;
        }
    }
    if(flag_found === 1)
    {
        the_found_movie_details.Sheet1.push({
            "Serial": "19",
            "Movie_name": "Spider-Man",
            "Star_rating": "3",
            "Year": "2002",
            "isFeatured": "FALSE"
        });
        the_found_movie_details.Sheet1.push({
            "Serial": "45",
            "Movie_name": "Iron Man",
            "Star_rating": "4",
            "Year": "2008",
            "isFeatured": "FALSE"
        });
            the_found_movie_details.Sheet1.push({
            "Serial": "22",
            "Movie_name": "Indiana Jones and the Kingdom of the Crystal Skull",
            "Star_rating": "4",
            "Year": "2008",
            "isFeatured": "FALSE"
        });
        res.render("home.ejs",{
        "list_of_movies"  : the_found_movie_details,
        "list_of_all_the_thumbnails" : list_of_all_the_thumbnails,
        });
    }
    else
    {
        res.render("home.ejs",{
        "list_of_movies"  : list_of_all_movies,
        "list_of_all_the_thumbnails" : list_of_all_the_thumbnails,
        });      
    }

});

app.post("/home_sort_by_year",function(req,res){

    var list_of_all_movies_sorted_by_year = {
    "Sheet1" : list_of_all_movies.Sheet1.sort((a, b) => (a.Year > b.Year) ? 1 : -1),
    };
    // console.log(list_of_all_movies_sorted_by_year);

    // console.log(list_of_all_movies.Sheet1.length);

    res.render("home.ejs",{
        "list_of_movies"  : list_of_all_movies_sorted_by_year,
        "list_of_all_the_thumbnails" : list_of_all_the_thumbnails,
    });
    console.log("THIS IS SORT BY YEAR");
});

app.post("/home_sort_by_rating",function(req,res){

    var list_of_all_movies_sorted_by_star_rating = {
    "Sheet1" : list_of_all_movies.Sheet1.sort((a, b) => (a.Star_rating < b.Star_rating) ? 1 : -1),
    } ;
    // console.log(list_of_all_movies_sorted_by_star_rating);

    res.render("home.ejs",{
        "list_of_movies"  : list_of_all_movies_sorted_by_star_rating,
        "list_of_all_the_thumbnails" : list_of_all_the_thumbnails,
    }); 
    console.log("THIS IS SORT BY RATING");
});

app.get("/info_page/:Movie_name/:Star_rating/:Year",function(req,res){

    // res.send(req.params);
    var details_of_the_movie = req.params;
    console.log(details_of_the_movie);
    // console.log(details_of_the_movie);
    res.render("info_page.ejs",{
        "list_of_featured_movies" : list_of_featured_movies, 
        "list_of_all_the_thumbnails" : list_of_all_the_thumbnails,
        "details_of_the_movie" : details_of_the_movie,
    });
    console.log("THE POST REQUEST WAS CAUGHT FOR ANY MOVIE");
});

app.get("/test",function(req,res){
    res.render("test.ejs")
});

app.get("*",function(req,res)
{
	res.render("error_page.ejs");
});

app.listen( process.env.PORT || 8000 , function(){
	console.log("SERVER 8000 HAS STARTED");
});



